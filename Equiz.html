let questions = [];

fetch("questions.json")
  .then(response => response.json())
  .then(data => {
    questions = data;
    console.log("Loaded questions: ", questions);
    startQuiz();
  })
  .catch(error => console.error("Error loading JSON:", error));

function startQuiz() {
    console.log("Welcome to the English grammar quiz");

    let userName = prompt("Enter your Name");
    console.log("Hello " + userName + "! Let's start the Quiz");

    let Number;
    do {
        let input = prompt("Enter number of questions");
        Number = parseInt(input);
        if (isNaN(Number) || Number <= 0)
            alert("Invalid Number\nplease try again");
    } while (isNaN(Number) || Number <= 0);

    console.log("You entered " + Number);

    let selectedQuestions = shuffleArray([...questions]).slice(0, Number);

    const correctSound = new Audio("https://www.soundjay.com/buttons/sounds/button-3.mp3");
    const wrongSound = new Audio("https://www.soundjay.com/buttons/sounds/beep-07.mp3");

    let score = 0;

    for (let i = 0; i < selectedQuestions.length; i++) {
        let q = selectedQuestions[i];
        let answer = parseInt(prompt(`Question ${i+1}: ${q.text}\n1) ${q.op1}\n2) ${q.op2}\n3) ${q.op3}`));
        if (answer === q.correct) {
            console.log("Correct ðŸ”” ðŸ’¯");
            correctSound.play();
            score++;
        } else {
            console.log("Incorrect ðŸ”Š");
            wrongSound.play();
        }
    }

    console.log(`Quiz finished! Your score: ${score} / ${selectedQuestions.length}`);
}

function shuffleArray(array) {
    return array.sort(() => Math.random() - 0.5);
}
